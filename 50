boolean isCyclic(int V, ArrayList<ArrayList<Integer>> adj) {
    boolean[] visited = new boolean[V];
    boolean[] path = new boolean[V];

    for (int i = 0; i < V; i++) {
        if (!visited[i]) {
            if (dfsCycle(i, visited, path, adj))
                return true;
        }
    }
    return false;
}

boolean dfsCycle(int node, boolean[] visited, boolean[] path,
                 ArrayList<ArrayList<Integer>> adj) {
    visited[node] = true;
    path[node] = true;

    for (int it : adj.get(node)) {
        if (!visited[it]) {
            if (dfsCycle(it, visited, path, adj))
                return true;
        } else if (path[it]) {
            return true;
        }
    }

    path[node] = false;
    return false;
}
